// Simulate for some time in the past, add inputs at time 0.0, then follow for additional time
//directive sample -96*3600.0,24*3600.0 1000
directive sample -2*24*3600, 1*24*3600.0 1000
directive simulation deterministicstiff
directive plot Me-P1; Me-P2

// Declare all of the parameters that are to be used
directive parameters [ in1 = 0.0
                     ; in2 = 0.0; upreg1 =0.0; upreg2 = 0.0; upreg3 = 0.0; upreg4 = 0.0
					 ; upfactor1,(1.0,5000.0),1.0,log,random
					 ; upfactor2,(1.0,5000.0),1.0,log,random
					 ; upfactor3,(1.0,5000.0),1.0,log,random
					 ; upfactor4,(1.0,5000.0),1.0,log,random			  
					 ; offset1,(0.0,500.0),1.0,real,random
					 ; offset2,(0.0,5000.0),1.0,real,random
					 ; offset3,(0.0,500.0),1.0,real,random
					 ; offset4,(0.0,5000.0),1.0,real,random
					 ; offset5,(0.0,700.0),1.0,real,random
					 ; offset6,(0.0,1000.0),1.0,real,random
					 ; offset7,(0.0,1000.0),1.0,real,random
					 ; offset8,(0.0,5000.0),1.0,real,random
					 ; s1,(1e-4,1000.0),1.0,log,random
					 ; s2,(1e-4,1000.0),1.0,log,random
					 ; sf1,(1e-6,1000.0),1.0,log,random 
					 ; sf2,(1e-6,1000.0),1.0,log,random
					 ; b2, (1e-15,1e-7),2.755e-10,log,random
					  ]

//Auto-generated sweep 151118
directive sweep mysweep1 = {upreg1 = [0.0], upreg2 = [0.0], upreg3 = [0.0], upreg4 = [0.0], (in1,in2) = [(75.00,73.00),(141.00,87.00),(554.00,84.00),(1810.00,83.00),(5758.00,84.00),(18271.00,81.00),(58325.00,83.00),(138343.00,82.00),(86.00,124.00),(177.00,147.00),(504.00,174.00),(1784.00,166.00),(5640.00,160.00),(18000.00,156.00),(57932.00,155.00),(141928.00,156.00),(77.00,606.00),(179.00,586.00),(595.00,576.00),(1764.00,624.00),(5458.00,629.00),(18249.00,641.00),(56478.00,594.00),(140757.00,603.00),(77.00,1848.00),(177.00,1817.00),(615.00,1794.00),(1888.00,1828.00),(5612.00,1975.00),(17223.00,2005.00),(55104.00,2034.00),(141189.00,1991.00),(81.00,5668.00),(173.00,5663.00),(604.00,5582.00),(1945.00,5470.00),(5996.00,5791.00),(17968.00,6220.00),(54161.00,6472.00),(138039.00,6708.00),(80.00,17910.00),(172.00,17784.00),(566.00,17414.00),(2027.00,17216.00),(6367.00,17192.00),(19105.00,18022.00),(55538.00,18741.00),(139466.00,18809.00),(78.00,55790.00),(173.00,54252.00),(568.00,53250.00),(1891.00,51310.00),(6607.00,50054.00),(19437.00,51525.00),(58822.00,53923.00),(145405.00,56714.00),(76.00,139676.00),(169.00,140427.00),(549.00,141665.00),(1735.00,140163.00),(6396.00,137887.00),(19581.00,130416.00),(58608.00,137091.00),(150350.00,138883.00)] }

//Auto-generated sweep 151118
directive sweep mysweep2 = {upreg1 = [1.0], upreg2 = [0.0], upreg3 = [0.0], upreg4 = [0.0], (in1,in2) = [(76.00,77.00),(134.00,90.00),(562.00,86.00),(1805.00,84.00),(5450.00,84.00),(17922.00,83.00),(49242.00,86.00),(130002.00,82.00),(86.00,127.00),(168.00,151.00),(518.00,186.00),(1764.00,175.00),(5336.00,164.00),(17453.00,152.00),(52668.00,155.00),(131778.00,141.00),(80.00,566.00),(177.00,545.00),(608.00,555.00),(1762.00,626.00),(5131.00,659.00),(15987.00,642.00),(51795.00,587.00),(141045.00,646.00),(79.00,1740.00),(171.00,1757.00),(657.00,1706.00),(1889.00,1774.00),(5334.00,1913.00),(16759.00,2009.00),(48808.00,2055.00),(129004.00,2211.00),(82.00,5566.00),(166.00,5290.00),(643.00,5068.00),(1977.00,5178.00),(5839.00,5502.00),(17431.00,6010.00),(50379.00,6468.00),(131911.00,6993.00),(83.00,16904.00),(160.00,16771.00),(604.00,16661.00),(1991.00,15904.00),(6276.00,16246.00),(18215.00,16984.00),(53019.00,18094.00),(133237.00,18677.00),(81.00,52202.00),(169.00,50271.00),(606.00,47830.00),(2098.00,45885.00),(6320.00,41551.00),(19739.00,45583.00),(56378.00,49030.00),(141222.00,56168.00),(72.00,127092.00),(158.00,143586.00),(691.00,152358.00),(2362.00,110572.00),(5672.00,127529.00),(18031.00,134840.00),(61111.00,146628.00),(150548.00,135747.00)] }

//Auto-generated sweep 151118
directive sweep mysweep3 = {upreg1 = [0.0], upreg2 = [0.0], upreg3 = [0.0], upreg4 = [0.0], (in1,in2) = [(75.00,72.00),(141.00,87.00),(551.00,83.00),(1821.00,83.00),(5637.00,83.00),(18477.00,80.00),(57926.00,84.00),(137236.00,85.00),(85.00,125.00),(177.00,147.00),(508.00,175.00),(1787.00,166.00),(5698.00,161.00),(17917.00,154.00),(58226.00,153.00),(140370.00,152.00),(78.00,613.00),(179.00,592.00),(589.00,567.00),(1793.00,631.00),(5505.00,643.00),(16849.00,625.00),(55972.00,604.00),(140953.00,580.00),(78.00,1870.00),(175.00,1850.00),(631.00,1801.00),(1862.00,1871.00),(5603.00,1999.00),(17304.00,1973.00),(55611.00,1952.00),(142743.00,1963.00),(82.00,5770.00),(174.00,5731.00),(611.00,5549.00),(1974.00,5492.00),(5990.00,5787.00),(17418.00,6430.00),(55758.00,6646.00),(135597.00,6386.00),(79.00,18164.00),(174.00,17889.00),(578.00,17710.00),(1947.00,17065.00),(6504.00,17800.00),(19588.00,17882.00),(55011.00,19123.00),(135639.00,19891.00),(79.00,57085.00),(172.00,56293.00),(561.00,52921.00),(2047.00,51228.00),(6309.00,49401.00),(19652.00,53365.00),(58065.00,53450.00),(143543.00,57963.00),(80.00,137440.00),(174.00,140006.00),(598.00,142316.00),(1899.00,132069.00),(6010.00,134841.00),(19542.00,128175.00),(62263.00,134760.00),(144017.00,137959.00)] }

//Auto-generated sweep 151118
directive sweep mysweep4 = {upreg1 = [1.0], upreg2 = [0.0], upreg3 = [0.0], upreg4 = [0.0], (in1,in2) = [(76.00,77.00),(134.00,89.00),(569.00,86.00),(1779.00,83.00),(5529.00,82.00),(17655.00,81.00),(53026.00,82.00),(138237.00,83.00),(86.00,129.00),(169.00,150.00),(513.00,184.00),(1746.00,176.00),(5400.00,167.00),(17692.00,157.00),(53767.00,149.00),(126047.00,144.00),(80.00,551.00),(178.00,545.00),(601.00,550.00),(1751.00,622.00),(5073.00,661.00),(16530.00,648.00),(53437.00,600.00),(159139.00,427.00),(80.00,1790.00),(170.00,1741.00),(648.00,1702.00),(1887.00,1791.00),(5269.00,1830.00),(16608.00,2041.00),(48437.00,2065.00),(132002.00,1730.00),(81.00,5147.00),(165.00,5303.00),(652.00,5126.00),(1961.00,5076.00),(5872.00,5601.00),(17475.00,6160.00),(50090.00,6515.00),(141283.00,6208.00),(79.00,17330.00),(165.00,16888.00),(667.00,16500.00),(1940.00,15384.00),(6348.00,15708.00),(18751.00,17273.00),(50256.00,18421.00),(133331.00,17300.00),(81.00,52549.00),(173.00,51639.00),(680.00,45279.00),(2046.00,54830.00),(6574.00,49583.00),(18989.00,45330.00),(57360.00,51538.00),(133542.00,54938.00),(79.00,152850.00),(154.00,127919.00),(527.00,117240.00),(1139.00,125535.00),(7204.00,142738.00),(19841.00,119952.00),(61142.00,130230.00),(156711.00,151467.00)] }

//Auto-generated sweep 151125
directive sweep mysweep5 = {upreg2 = [0.0], upreg1 = [0.0], upreg3 = [0.0], upreg4 = [0.0], (in1,in2) = [(74.00,76.00),(143.00,89.00),(557.00,86.00),(1838.00,85.00),(5690.00,85.00),(18235.00,84.00),(57087.00,84.00),(141087.00,86.00),(85.00,125.00),(180.00,154.00),(496.00,184.00),(1798.00,167.00),(5666.00,164.00),(18123.00,161.00),(59134.00,164.00),(141894.00,163.00),(78.00,616.00),(186.00,589.00),(570.00,556.00),(1772.00,622.00),(5540.00,642.00),(17408.00,651.00),(58518.00,573.00),(140491.00,531.00),(78.00,1878.00),(180.00,1874.00),(595.00,1826.00),(1867.00,1874.00),(5631.00,1981.00),(17039.00,2011.00),(55279.00,1964.00),(140685.00,1984.00),(81.00,5710.00),(179.00,5754.00),(581.00,5519.00),(1968.00,5556.00),(6045.00,5852.00),(17448.00,6345.00),(55014.00,6744.00),(141924.00,6645.00),(82.00,17894.00),(180.00,17711.00),(543.00,17205.00),(1978.00,17039.00),(6372.00,17382.00),(18848.00,18484.00),(56717.00,19230.00),(140263.00,19269.00),(74.00,58951.00),(176.00,55729.00),(528.00,55850.00),(1933.00,53502.00),(6496.00,51180.00),(19593.00,52018.00),(59431.00,54334.00),(144747.00,57499.00),(71.00,143278.00),(176.00,140665.00),(540.00,139671.00),(1846.00,134490.00),(6298.00,136989.00),(19811.00,136127.00),(61645.00,134742.00),(147912.00,139682.00)] }

//Auto-generated sweep 151125
directive sweep mysweep6 = {upreg2 = [1.0], upreg1 = [0.0], upreg3 = [0.0], upreg4 = [0.0], (in1,in2) = [(75.00,79.00),(135.00,91.00),(570.00,87.00),(1808.00,87.00),(5626.00,85.00),(17444.00,84.00),(54471.00,87.00),(137670.00,83.00),(85.00,129.00),(170.00,157.00),(516.00,188.00),(1750.00,173.00),(5392.00,165.00),(17390.00,158.00),(53401.00,155.00),(140546.00,155.00),(80.00,575.00),(181.00,552.00),(589.00,559.00),(1706.00,631.00),(4974.00,653.00),(16365.00,666.00),(52638.00,617.00),(154044.00,473.00),(78.00,1798.00),(173.00,1760.00),(642.00,1719.00),(1850.00,1806.00),(5425.00,1924.00),(16932.00,2066.00),(47106.00,1969.00),(122379.00,1972.00),(80.00,5713.00),(166.00,5470.00),(646.00,5125.00),(1926.00,5221.00),(5838.00,5632.00),(17364.00,6192.00),(49358.00,6506.00),(138121.00,6274.00),(78.00,17320.00),(158.00,17400.00),(624.00,16255.00),(2002.00,15230.00),(6353.00,16112.00),(18588.00,17459.00),(52798.00,18446.00),(136369.00,18160.00),(70.00,55070.00),(153.00,47045.00),(562.00,52819.00),(1944.00,50699.00),(6151.00,48594.00),(18970.00,47197.00),(55287.00,51492.00),(137834.00,56306.00),(57.00,137317.00),(145.00,142907.00),(722.00,148592.00),(2181.00,144764.00),(5472.00,128568.00),(21200.00,145993.00),(60472.00,145463.00),(140250.00,133643.00)] }

//Auto-generated sweep 151125
directive sweep mysweep7 = {upreg2 = [0.0], upreg1 = [0.0], upreg3 = [0.0], upreg4 = [0.0], (in1,in2) = [(74.00,76.00),(143.00,89.00),(555.00,86.00),(1822.00,85.00),(5649.00,85.00),(18425.00,86.00),(57796.00,85.00),(139935.00,87.00),(85.00,125.00),(180.00,153.00),(496.00,183.00),(1805.00,169.00),(5684.00,163.00),(18307.00,160.00),(58965.00,163.00),(139058.00,162.00),(79.00,624.00),(186.00,581.00),(574.00,558.00),(1756.00,627.00),(5384.00,619.00),(17633.00,609.00),(58680.00,598.00),(138487.00,548.00),(79.00,1856.00),(180.00,1849.00),(601.00,1823.00),(1880.00,1838.00),(5442.00,1978.00),(17236.00,1970.00),(54189.00,1955.00),(148001.00,1997.00),(82.00,5743.00),(178.00,5679.00),(580.00,5581.00),(1950.00,5578.00),(5932.00,5860.00),(17703.00,6359.00),(54849.00,6700.00),(136726.00,6536.00),(80.00,18321.00),(178.00,17610.00),(582.00,17503.00),(1998.00,16996.00),(6353.00,17314.00),(18831.00,18159.00),(56844.00,19235.00),(140377.00,19901.00),(77.00,58367.00),(175.00,55550.00),(547.00,54553.00),(1975.00,51350.00),(6638.00,52700.00),(19477.00,53079.00),(58340.00,54963.00),(145360.00,57893.00),(72.00,144251.00),(174.00,138811.00),(527.00,143483.00),(1899.00,142311.00),(6232.00,132245.00),(19406.00,133367.00),(61834.00,134578.00),(142778.00,137554.00)] }

//Auto-generated sweep 151125
directive sweep mysweep8 = {upreg2 = [1.0], upreg1 = [0.0], upreg3 = [0.0], upreg4 = [0.0], (in1,in2) = [(75.00,78.00),(135.00,90.00),(567.00,86.00),(1785.00,84.00),(5612.00,83.00),(17891.00,85.00),(54006.00,83.00),(130911.00,85.00),(84.00,129.00),(169.00,155.00),(516.00,188.00),(1739.00,171.00),(5504.00,165.00),(18202.00,154.00),(52234.00,153.00),(137815.00,163.00),(80.00,559.00),(180.00,546.00),(587.00,558.00),(1730.00,633.00),(5002.00,655.00),(16132.00,672.00),(53252.00,667.00),(123611.00,508.00),(78.00,1796.00),(172.00,1754.00),(634.00,1689.00),(1843.00,1810.00),(5468.00,1968.00),(16230.00,1988.00),(51213.00,1965.00),(137943.00,1845.00),(81.00,5795.00),(165.00,5504.00),(658.00,5178.00),(1980.00,5184.00),(5776.00,5667.00),(17219.00,6184.00),(51038.00,6587.00),(138003.00,6729.00),(83.00,16986.00),(161.00,16590.00),(599.00,16202.00),(1973.00,16281.00),(6330.00,16033.00),(18415.00,17530.00),(52961.00,18504.00),(137202.00,17850.00),(75.00,51261.00),(156.00,52083.00),(619.00,50911.00),(2063.00,46551.00),(6669.00,46087.00),(18602.00,49012.00),(55306.00,52103.00),(137415.00,54727.00),(69.00,141100.00),(174.00,135753.00),(603.00,117410.00),(2312.00,138930.00),(5799.00,145294.00),(18503.00,135525.00),(56585.00,129119.00),(141611.00,131823.00)] }

//Auto-generated sweep 151202
directive sweep mysweep9 = {upreg3 = [0.0], upreg1 = [0.0], upreg2 = [0.0], upreg4 = [0.0],(in1,in2) = [(77.00,78.00),(148.00,88.00),(558.00,87.00),(1799.00,85.00),(5703.00,85.00),(17953.00,86.00),(56664.00,87.00),(138250.00,89.00),(84.00,127.00),(179.00,148.00),(512.00,172.00),(1782.00,165.00),(5679.00,159.00),(17887.00,155.00),(58269.00,153.00),(141649.00,152.00),(80.00,598.00),(181.00,584.00),(590.00,561.00),(1793.00,624.00),(5344.00,644.00),(16946.00,640.00),(57265.00,624.00),(135205.00,595.00),(81.00,1861.00),(176.00,1833.00),(603.00,1778.00),(1902.00,1829.00),(5485.00,1935.00),(17063.00,2008.00),(54907.00,1978.00),(143352.00,1896.00),(83.00,5762.00),(174.00,5720.00),(587.00,5539.00),(1974.00,5537.00),(5959.00,5790.00),(17746.00,6316.00),(54442.00,6503.00),(138869.00,6503.00),(81.00,17959.00),(175.00,17388.00),(570.00,17656.00),(1968.00,17000.00),(6398.00,17135.00),(18843.00,17916.00),(55843.00,18964.00),(140523.00,19781.00),(81.00,56108.00),(171.00,54589.00),(551.00,51901.00),(1933.00,51789.00),(6546.00,50974.00),(19879.00,52732.00),(58192.00,54107.00),(141156.00,55793.00),(79.00,141410.00),(177.00,138834.00),(549.00,144002.00),(1866.00,134452.00),(6765.00,137988.00),(19731.00,134539.00),(61521.00,132326.00),(142891.00,137517.00)] }

//Auto-generated sweep 151202
directive sweep mysweep10 = {upreg3 = [1.0], upreg1 = [0.0], upreg2 = [0.0], upreg4 = [0.0], (in1,in2) = [(78.00,80.00),(137.00,89.00),(563.00,85.00),(1803.00,86.00),(5528.00,84.00),(17568.00,85.00),(53602.00,85.00),(128057.00,85.00),(84.00,130.00),(165.00,149.00),(525.00,179.00),(1736.00,169.00),(5363.00,160.00),(17256.00,148.00),(50489.00,151.00),(133197.00,155.00),(79.00,567.00),(173.00,544.00),(598.00,566.00),(1719.00,621.00),(5102.00,667.00),(16577.00,650.00),(51389.00,652.00),(144578.00,609.00),(80.00,1750.00),(164.00,1761.00),(650.00,1715.00),(1878.00,1763.00),(5419.00,1927.00),(16975.00,1986.00),(50591.00,2090.00),(126433.00,1969.00),(82.00,5408.00),(160.00,5323.00),(693.00,5037.00),(1986.00,5236.00),(5742.00,5563.00),(17169.00,6075.00),(50604.00,6573.00),(122209.00,5744.00),(82.00,16602.00),(159.00,17091.00),(584.00,16309.00),(1913.00,16775.00),(6440.00,16360.00),(19041.00,17626.00),(50722.00,18672.00),(129139.00,19024.00),(74.00,55557.00),(157.00,54126.00),(596.00,46235.00),(1975.00,40120.00),(7118.00,48054.00),(20174.00,46447.00),(55452.00,48955.00),(145832.00,53412.00),(63.00,141298.00),(171.00,133726.00),(637.00,106655.00),(1970.00,175762.00),(5897.00,115987.00),(19453.00,132622.00),(69233.00,135015.00),(146126.00,129593.00)] }

//Auto-generated sweep 151202
directive sweep mysweep11 = {upreg3 = [0.0], upreg1 = [0.0], upreg2 = [0.0], upreg4 = [0.0], (in1,in2) = [(77.00,78.00),(148.00,87.00),(549.00,86.00),(1821.00,86.00),(5690.00,84.00),(18053.00,85.00),(56858.00,87.00),(143689.00,87.00),(84.00,128.00),(180.00,147.00),(512.00,171.00),(1818.00,164.00),(5599.00,159.00),(17946.00,156.00),(58310.00,152.00),(140353.00,159.00),(81.00,604.00),(182.00,590.00),(593.00,559.00),(1795.00,615.00),(5537.00,631.00),(17301.00,611.00),(55392.00,614.00),(137852.00,581.00),(80.00,1876.00),(177.00,1821.00),(609.00,1798.00),(1916.00,1820.00),(5615.00,1950.00),(17434.00,1995.00),(54044.00,2033.00),(144700.00,2020.00),(84.00,5674.00),(174.00,5624.00),(596.00,5529.00),(1950.00,5450.00),(5993.00,5764.00),(17654.00,6235.00),(54632.00,6507.00),(139876.00,6448.00),(82.00,17742.00),(173.00,17718.00),(565.00,17248.00),(1976.00,17336.00),(6382.00,17272.00),(19127.00,17820.00),(56557.00,18874.00),(137682.00,19618.00),(81.00,55601.00),(173.00,55935.00),(531.00,56085.00),(1940.00,53328.00),(6591.00,50946.00),(19294.00,51485.00),(59989.00,53342.00),(142942.00,56066.00),(75.00,139036.00),(179.00,141258.00),(520.00,141966.00),(1841.00,136508.00),(6705.00,137386.00),(20135.00,142077.00),(61421.00,135242.00),(145764.00,136463.00)] }

//Auto-generated sweep 151202
directive sweep mysweep12 = {upreg3 = [1.0], upreg1 = [0.0], upreg2 = [0.0], upreg4 = [0.0], (in1,in2) = [(77.00,78.00),(137.00,88.00),(558.00,85.00),(1820.00,82.00),(5424.00,83.00),(18497.00,85.00),(52722.00,83.00),(137209.00,87.00),(84.00,130.00),(164.00,147.00),(523.00,179.00),(1745.00,165.00),(5336.00,159.00),(17274.00,150.00),(53985.00,143.00),(130806.00,132.00),(80.00,564.00),(171.00,541.00),(599.00,572.00),(1741.00,640.00),(5106.00,656.00),(17730.00,667.00),(49666.00,629.00),(123539.00,692.00),(80.00,1802.00),(165.00,1773.00),(645.00,1722.00),(1846.00,1818.00),(5438.00,1909.00),(16624.00,2025.00),(48572.00,2043.00),(123524.00,1984.00),(84.00,5674.00),(159.00,5446.00),(657.00,4909.00),(1936.00,5400.00),(5912.00,5665.00),(16948.00,5954.00),(48389.00,6300.00),(127953.00,6333.00),(84.00,17354.00),(159.00,16984.00),(577.00,16475.00),(2184.00,15780.00),(6468.00,16696.00),(19183.00,17629.00),(52753.00,18848.00),(126439.00,19993.00),(78.00,52559.00),(156.00,50076.00),(664.00,50565.00),(2085.00,49890.00),(7106.00,45714.00),(19819.00,46769.00),(55181.00,50822.00),(139773.00,57101.00),(76.00,137790.00),(161.00,150077.00),(639.00,191999.00),(1862.00,142992.00),(5907.00,127349.00),(18167.00,135351.00),(59200.00,136830.00),(150426.00,150364.00)] }

//Auto-generated sweep 150819
directive sweep mysweep13 = {upreg4 = [0.0], upreg1 = [0.0], upreg2 = [0.0], upreg3 = [0.0], (in1,in2) = [(73.00,82.00),(130.00,91.00),(541.00,88.00),(1829.00,88.00),(5734.00,86.00),(18459.00,87.00),(54568.00,88.00),(137313.00,90.00),(83.00,125.00),(159.00,159.00),(511.00,180.00),(1782.00,170.00),(5600.00,167.00),(18261.00,162.00),(56032.00,163.00),(139724.00,167.00),(81.00,572.00),(186.00,554.00),(520.00,540.00),(1779.00,575.00),(5510.00,605.00),(17915.00,607.00),(58888.00,550.00),(140944.00,530.00),(80.00,1767.00),(188.00,1797.00),(547.00,1900.00),(1802.00,1901.00),(5693.00,1880.00),(16702.00,1967.00),(47591.00,1989.00),(138331.00,1850.00),(85.00,5230.00),(199.00,5509.00),(547.00,5945.00),(1798.00,5785.00),(5796.00,5891.00),(17965.00,6161.00),(53662.00,6298.00),(138614.00,5953.00),(82.00,17851.00),(215.00,16378.00),(584.00,18061.00),(1754.00,19235.00),(5809.00,18831.00),(18150.00,18296.00),(55402.00,18742.00),(133384.00,18884.00),(87.00,47391.00),(210.00,51906.00),(671.00,49711.00),(1807.00,55725.00),(5558.00,59586.00),(17986.00,57991.00),(55326.00,53283.00),(141678.00,57172.00),(66.00,143345.00),(219.00,127165.00),(653.00,144656.00),(1968.00,134294.00),(5890.00,138421.00),(16248.00,139239.00),(51441.00,139561.00),(142044.00,130420.00)] }

//Auto-generated sweep 150819
directive sweep mysweep14 = {upreg4 = [1.0], upreg1 = [0.0], upreg2 = [0.0], upreg3 = [0.0], (in1,in2) = [(72.00,81.00),(124.00,92.00),(569.00,85.00),(1781.00,84.00),(6065.00,82.00),(16814.00,83.00),(48582.00,87.00),(104393.00,99.00),(84.00,126.00),(154.00,159.00),(520.00,180.00),(1731.00,166.00),(5677.00,160.00),(17138.00,149.00),(49317.00,158.00),(129693.00,175.00),(77.00,553.00),(173.00,542.00),(553.00,558.00),(1688.00,630.00),(5302.00,658.00),(15733.00,697.00),(83705.00,752.00),(77.00,1781.00),(170.00,1754.00),(600.00,1828.00),(1791.00,1780.00),(5299.00,1936.00),(16684.00,2059.00),(41460.00,2229.00),(80.00,5411.00),(182.00,5518.00),(576.00,5644.00),(1794.00,5557.00),(6057.00,5945.00),(17347.00,5853.00),(45458.00,5744.00),(109346.00,3363.00),(86.00,15748.00),(186.00,15668.00),(536.00,15766.00),(2110.00,16772.00),(6040.00,18959.00),(18664.00,19880.00),(38531.00,20264.00),(84.00,50161.00),(209.00,47719.00),(650.00,48694.00),(1935.00,54963.00),(6218.00,47091.00),(19526.00,53609.00),(42852.00,63061.00),(156350.00,81140.00),(50.00,189263.00),(242.00,110007.00),(302.00,111158.00),(2016.00,135198.00),(6034.00,112315.00),(11254.00,143961.00),(36484.00,118004.00)] }

//Auto-generated sweep 150819
directive sweep mysweep15 = {upreg4 = [0.0], upreg1 = [0.0], upreg2 = [0.0], upreg3 = [0.0], (in1,in2) = [(74.00,78.00),(131.00,89.00),(542.00,86.00),(1790.00,85.00),(5894.00,84.00),(18680.00,84.00),(56415.00,85.00),(129160.00,86.00),(84.00,122.00),(161.00,152.00),(509.00,176.00),(1794.00,164.00),(5588.00,159.00),(18159.00,159.00),(57878.00,160.00),(134026.00,159.00),(79.00,563.00),(183.00,559.00),(532.00,557.00),(1775.00,595.00),(5430.00,607.00),(17877.00,598.00),(54361.00,582.00),(140008.00,590.00),(79.00,1781.00),(188.00,1826.00),(552.00,1929.00),(1850.00,1819.00),(5366.00,1905.00),(17665.00,1970.00),(50722.00,1978.00),(147156.00,1843.00),(84.00,5246.00),(199.00,5419.00),(549.00,5802.00),(1809.00,5842.00),(5764.00,5904.00),(17502.00,6166.00),(54533.00,6041.00),(133095.00,6521.00),(83.00,17349.00),(211.00,16330.00),(588.00,17898.00),(1782.00,18907.00),(5776.00,18042.00),(19213.00,17696.00),(54509.00,18955.00),(138204.00,19150.00),(80.00,57776.00),(221.00,46873.00),(629.00,50680.00),(1840.00,57004.00),(5556.00,59811.00),(19492.00,56461.00),(55609.00,50790.00),(128414.00,55198.00),(62.00,147652.00),(188.00,134456.00),(640.00,137153.00),(2018.00,138552.00),(5761.00,141972.00),(17345.00,141752.00),(57051.00,135277.00),(151953.00,127009.00)] }

//Auto-generated sweep 150819
directive sweep mysweep16 = {upreg4 = [1.0], upreg1 = [0.0], upreg2 = [0.0], upreg3 = [0.0], (in1,in2) = [(72.00,81.00),(124.00,92.00),(585.00,85.00),(1781.00,84.00),(5588.00,87.00),(18006.00,85.00),(37341.00,86.00),(110050.00,107.00),(84.00,126.00),(159.00,160.00),(515.00,185.00),(1766.00,166.00),(5372.00,158.00),(16381.00,148.00),(50295.00,148.00),(138294.00,133.00),(81.00,567.00),(173.00,552.00),(566.00,547.00),(1791.00,599.00),(5031.00,681.00),(17114.00,621.00),(47158.00,546.00),(77.00,1837.00),(176.00,1734.00),(588.00,1800.00),(1758.00,1863.00),(5532.00,1906.00),(16237.00,1966.00),(48981.00,2370.00),(84.00,5171.00),(181.00,5326.00),(557.00,5438.00),(1951.00,5682.00),(5638.00,5844.00),(17882.00,6110.00),(52493.00,7081.00),(106982.00,6250.00),(82.00,16198.00),(186.00,16653.00),(595.00,16747.00),(1778.00,15635.00),(5949.00,16737.00),(17609.00,17883.00),(52969.00,18026.00),(67.00,52358.00),(198.00,47501.00),(640.00,52760.00),(1844.00,52996.00),(6287.00,45697.00),(17852.00,50263.00),(47597.00,56352.00),(120349.00,42343.00),(100.00,155179.00),(128.00,148909.00),(670.00,148893.00),(2043.00,127613.00),(2999.00,104373.00),(19247.00,125588.00),(38792.00,121407.00)] }



// We add a scaled quantity of each input. The scale factors are s1 and s2 respectively
// Eventually, we'll be optimizing for s1 and s2
directive event I1 s1*in1 @ 0.0
directive event I2 s2*in2 @ 0.0

// Specify the relationship between model simulation and data, and MCMC settings
directive fit { mysweep1; KSNSSLnone; [Me-P1*SF1+OFF1] }
directive fit { mysweep2; KSNSSLIFN; [Me-P1*SF1+OFF1] }
directive fit { mysweep3; KSNASNnone; [Me-P2*SF2+OFF2] }
directive fit { mysweep4; KSNASNIFN; [Me-P2*SF2+OFF2] }
directive fit { mysweep5; METISSLASNnone; [Me-P1*SF1+OFF3] }
directive fit { mysweep6; METISSLASNifn; [Me-P1*SF1+OFF3] }
directive fit { mysweep7; METIASNSSLnone; [Me-P2*SF2+OFF4] }
directive fit { mysweep8; METIASNSSLifn; [Me-P2*SF2+OFF4] }
directive fit { mysweep9; ASNEA151202SSLnone; [Me-P1*SF1+OFF5] }
directive fit { mysweep10; ASNEA151202SSLIFN; [Me-P1*SF1+OFF5] }
directive fit { mysweep11; ASNEA151202ASNnone; [Me-P2*SF2+OFF6] }
directive fit { mysweep12; ASNEA151202ASNIFN; [Me-P2*SF2+OFF6] }
directive fit { mysweep13; V_SSL_surf_none; [Me-P1*SF1+OFF7] }
directive fit { mysweep14; V_SSL_surf_ifn1; [Me-P1*SF1+OFF7] }
directive fit { mysweep15; V_ASN_surf_none; [Me-P2*SF2+OFF8] }
directive fit { mysweep16; V_ASN_surf_ifn1; [Me-P2*SF2+OFF8] }
directive fit_run { burnin = 5000; samples = 30000; thin = 10; noisemodel = 1 }

// Standard parameter values
rate dMe = 5.193e-5;//9.329349e-5;
rate b0 = 2.755e-10;//3.177334e-11;
rate b1 = 2.755e-10;
//rate b2 = 2.755e-10;
rate c = 8.302928e-8;
rate dP = 0.13;
rate uT = 1.184643e-6;
rate vT = 0.0011091974705091;
rate bT = 1.662768e-9;
rate gT = 1505;
rate dT = 0.001725968;
rate e = 7.071e-4;//0.1141804;
rate gM = 150.5;
rate dM = 7.9892e-5;
rate q = 21035;

// Specialising peptide supply and off-rates
rate g0 = 45000.0;
rate u1 = 2.66667E-05;
//2.3968e-05;//1.5856e-05;
rate u2 = 4.31e-05;
//4.83333E-05;
//4.4777e-05;//3.4179e-05;
rate u0 = 1e-4;

spec P1; spec I1;
spec P2; spec I2;
spec P0; spec I0; 

// You have to use a species in the fit directive, so just initialise a constant species with a parameterized value
init SF1 sf1 |
init SF2 sf2 |
init OFF1 offset1 |
init OFF2 offset2 |
init OFF3 offset3 |
init OFF4 offset4 |
init OFF5 offset5 |
init OFF6 offset6 |
init OFF7 offset7 |
init OFF8 offset8 |

// Standard modular definition of the MHC model
module Pep(spec Pi,Ii; rate gi,ui,bi){
  Ii  ~->{gi} Pi | Pi ->{dP} |
  M + Pi <->{bi}{ui} M-Pi |
  T-M + Pi <->{c}{ui*q} T-M-Pi |
  T-M-Pi ->{vT} T + M-Pi |
  M-Pi ->{e} Me-Pi |
  Me-Pi ->{ui} Me
};

<->[gM + upreg1*upfactor1 + upreg2*upfactor2 + upreg3*upfactor3 + upreg4*upfactor4]{dM} M |
<->[10*(gM + upreg1*upfactor1 + upreg2*upfactor2 + upreg3*upfactor3 + upreg4*upfactor4)]{dT} T |
T + M <->{bT}{uT} T-M |
Me ->{dMe} |

// Instantiate the three peptides (target, competitor, background) with BG supplied at rate g0
Pep(P1,I1,1.0,u1,b1) |
Pep(P2,I2,1.0,u2,b2) |
init I0 1 | Pep(P0,I0,g0,u0,b0)